CREATE TABLE DimProduct (
    ProductID varchar(8000),
    ProductName VARCHAR(100),
    Category VARCHAR(50),
    Price FLOAT,
    FileName VARCHAR(100),
    LoadDate DATETIME2(0)
);


CREATE TABLE FileTracker (
    FileName VARCHAR(100) ,
    LoadDate DATETIME2(0)
);

select * from FileTracker
select * from DimProduct

---------------------------------------------------------------------------
TO TEST THE PIPRLINR 1 RECORD WE WILL INSERT MANUALLY- 
insert into FileTracker values('product_2024-07-01.csv','')
-------------------------------------------------------------------
Lookup query
SELECT fileName FROM file_tracker;

------------------------------------------------------------------------

fILTER ACTIVITY - 
filter - @not(contains(string(activity('Lookup1').output.value), item().name))

--------------------------------------------------------------------------------------------------

script activity - INSERT INTO FileTracker (FileName, LoadDate)
VALUES ('@{item().name}', GETUTCDATE());

-------------------------------------------------------------------------------------------------------
